# 项目优化检查清单

**版本**: 1.4.0  
**日期**: 2025-01-18

这是一个快速检查清单，用于跟踪项目优化进度。

---

## ✅ 代码质量检查

### 代码分析
- [ ] 运行 `flutter analyze`，确保 0 warnings
- [ ] 运行 `dart fix --apply` 自动修复问题
- [ ] 手动检查并修复剩余问题
- [ ] 确保所有测试通过 (`flutter test`)

### 代码清理
- [ ] 移除未使用的导入
- [ ] 移除未使用的变量和方法
- [ ] 删除注释掉的代码
- [ ] 移除调试用的 print 语句
- [ ] 清理 TODO 注释

### 代码规范
- [ ] 使用 const 构造函数
- [ ] 添加尾随逗号
- [ ] 使用单引号
- [ ] 声明返回类型
- [ ] 使用 final 字段

---

## 📦 依赖管理

### 依赖更新
- [ ] 运行 `flutter pub outdated` 检查过时的包
- [ ] 更新 patch 版本（0.0.x）
- [ ] 测试 minor 版本更新（0.x.0）
- [ ] 评估 major 版本更新（x.0.0）
- [ ] 更新 pubspec.yaml
- [ ] 运行 `flutter pub get`

### 依赖清理
- [ ] 移除未使用的依赖
- [ ] 检查依赖树 (`dart pub deps`)
- [ ] 确认所有依赖都有用途

---

## 🧪 测试完善

### 测试执行
- [ ] 运行所有单元测试
- [ ] 运行 Widget 测试
- [ ] 运行集成测试
- [ ] 生成测试覆盖率报告

### 测试覆盖率
- [ ] 当前覆盖率: ____%
- [ ] 目标覆盖率: 80%+
- [ ] 为未覆盖的核心代码添加测试

### 测试质量
- [ ] 添加边界条件测试
- [ ] 添加异常情况测试
- [ ] 使用 Mock 隔离依赖
- [ ] 测试异步操作

---

## 📱 移动端测试（iOS/Android）

### iOS 测试
- [ ] 在模拟器上运行
- [ ] 在真机上运行
- [ ] 测试权限请求（相册、文件、网络）
- [ ] 测试所有核心功能
- [ ] 测试屏幕旋转
- [ ] 测试暗色模式
- [ ] 检查内存使用
- [ ] 构建 release 版本

### Android 测试
- [ ] 在模拟器上运行
- [ ] 在真机上运行
- [ ] 测试权限请求
- [ ] 测试所有核心功能
- [ ] 测试不同屏幕尺寸
- [ ] 测试暗色模式
- [ ] 检查内存使用
- [ ] 构建 APK

### 移动端功能验证
- [ ] 对话发送和接收
- [ ] 流式响应显示
- [ ] 图片上传功能
- [ ] 图片查看和保存
- [ ] 文件选择和保存
- [ ] Markdown 渲染
- [ ] Agent 工具调用
- [ ] MCP 服务连接
- [ ] 数据导出（Markdown/PDF）
- [ ] 设置保存和加载

---

## 💻 桌面端测试（macOS/Windows/Linux）

### macOS 测试
- [ ] 应用启动正常
- [ ] 窗口管理功能
- [ ] 系统托盘功能
- [ ] 原生菜单功能
- [ ] 快捷键功能
- [ ] 文件拖放功能
- [ ] 所有核心功能
- [ ] 构建 release 版本

### Windows 测试
- [ ] 应用启动正常
- [ ] 窗口管理功能
- [ ] 系统托盘功能
- [ ] 快捷键功能
- [ ] 所有核心功能
- [ ] 构建 release 版本

### Linux 测试
- [ ] 应用启动正常
- [ ] 窗口管理功能
- [ ] 所有核心功能
- [ ] 构建 release 版本

### 桌面端功能验证
- [ ] 所有移动端功能
- [ ] 窗口大小记忆
- [ ] 多窗口支持（如有）
- [ ] 系统通知
- [ ] 文件关联（如有）

---

## 🌐 Web 端测试

### 浏览器兼容性
- [ ] Chrome/Edge 测试
- [ ] Safari 测试
- [ ] Firefox 测试

### PWA 功能
- [ ] 安装到桌面
- [ ] Service Worker 工作正常
- [ ] 离线支持（如实现）
- [ ] manifest.json 配置正确

### 响应式设计
- [ ] 桌面视图（1920x1080）
- [ ] 平板视图（768x1024）
- [ ] 移动视图（375x667）

### Web 功能验证
- [ ] 所有核心功能
- [ ] 文件上传下载
- [ ] 剪贴板操作
- [ ] 浏览器控制台无错误

### Web 性能
- [ ] 首次加载时间 < 5s
- [ ] 交互响应流畅
- [ ] 资源缓存有效
- [ ] 构建 release 版本

---

## ⚡ 性能优化

### 资源优化
- [ ] 检查图片大小（目标 < 500KB/张）
- [ ] 压缩背景图片
- [ ] 提供多分辨率资源
- [ ] 考虑使用 WebP 格式

### Bundle 优化
- [ ] 分析 bundle 大小
- [ ] 启用代码混淆
- [ ] 启用 tree-shaking
- [ ] 移除未使用的资源
- [ ] 检查最终大小

### 代码性能
- [ ] 避免不必要的 Widget 重建
- [ ] 使用 const 构造函数
- [ ] 优化列表渲染
- [ ] 实现图片缓存
- [ ] 检查内存泄漏

### 性能指标
- [ ] 启动时间 < 3s（移动端）
- [ ] UI 流畅度 60fps
- [ ] 内存占用合理
- [ ] 网络请求优化

---

## 📚 文档更新

### 项目文档
- [ ] 更新 README.md
- [ ] 更新 CHANGELOG.md
- [ ] 更新 FEATURES.md
- [ ] 更新 architecture.md
- [ ] 添加/更新截图

### API 文档
- [ ] 生成 Dart API 文档
- [ ] 更新 API 使用说明
- [ ] 添加代码示例

### 开发文档
- [ ] 更新开发指南
- [ ] 创建/更新 CONTRIBUTING.md
- [ ] 添加常见问题解答

---

## 🔧 CI/CD 配置

### GitHub Actions
- [ ] 配置代码分析工作流
- [ ] 配置测试工作流
- [ ] 配置构建工作流
- [ ] 配置覆盖率报告
- [ ] 测试工作流运行正常

### 自动化
- [ ] 设置 pre-commit hooks
- [ ] 配置自动格式化
- [ ] 配置自动发布（可选）

---

## 🎯 核心功能验证

### 对话功能
- [ ] 创建新对话
- [ ] 发送消息
- [ ] 接收流式响应
- [ ] 编辑消息
- [ ] 删除消息
- [ ] 搜索对话
- [ ] 对话分组
- [ ] 导出对话

### Agent 系统
- [ ] 查看内置 Agent
- [ ] 创建自定义 Agent
- [ ] 编辑 Agent 配置
- [ ] 删除 Agent
- [ ] 在对话中使用 Agent
- [ ] Agent 工具调用
- [ ] Agent 持久化

### MCP 集成
- [ ] 添加 MCP 服务器
- [ ] 配置 MCP 连接
- [ ] 测试 MCP 工具
- [ ] 访问 MCP 资源
- [ ] MCP 健康检查
- [ ] MCP 持久化

### 模型管理
- [ ] 添加 API 配置
- [ ] 刷新模型列表
- [ ] 查看模型详情
- [ ] 设置默认模型
- [ ] 配置模型参数

### 设置功能
- [ ] 主题切换
- [ ] 字体大小调整
- [ ] API 配置
- [ ] 数据导出
- [ ] 数据导入
- [ ] 设置持久化

---

## 📊 最终检查

### 构建验证
- [ ] iOS 构建成功
- [ ] Android 构建成功
- [ ] macOS 构建成功
- [ ] Windows 构建成功
- [ ] Linux 构建成功
- [ ] Web 构建成功

### 质量指标
- [ ] 代码分析: 0 warnings
- [ ] 测试: 100% 通过
- [ ] 覆盖率: ____% (目标 80%+)
- [ ] 性能: 符合预期
- [ ] 文档: 完整更新

### 发布准备
- [ ] 版本号已更新
- [ ] CHANGELOG 已更新
- [ ] 所有平台构建通过
- [ ] 核心功能验证完成
- [ ] 文档已完善

---

## 📝 注意事项

### 测试环境
- Flutter SDK: 3.8.0+
- Dart SDK: 3.8.0+
- iOS: 12.0+
- Android: API 21+
- macOS: 12.0+
- Windows: 10/11
- Linux: Ubuntu 20.04+

### 常见问题
1. **测试失败**: 检查依赖是否最新，清理缓存后重试
2. **构建失败**: 查看错误日志，检查平台配置
3. **性能问题**: 使用 DevTools 分析性能瓶颈

### 快速命令
```bash
# 代码分析
flutter analyze

# 运行测试
flutter test

# 生成覆盖率
flutter test --coverage

# 更新依赖
flutter pub outdated
flutter pub upgrade

# 构建各平台
flutter build web --release
flutter build macos --release
flutter build ios --release --no-codesign
flutter build apk --release

# 运行测试脚本
./scripts/test_all_platforms.sh
```

---

**完成日期**: ___________  
**检查人**: ___________  
**版本**: 1.4.0
